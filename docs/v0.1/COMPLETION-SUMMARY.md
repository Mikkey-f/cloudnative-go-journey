# v0.1 å®Œæˆæ€»ç»“ ğŸ‰

> CloudNative Go Journey v0.1 åŸºç¡€ç‰ˆå·²å®Œæˆï¼

## âœ… äº¤ä»˜æˆæœ

### 1. Go åº”ç”¨æœåŠ¡

```
âœ… HTTP API æœåŠ¡ï¼ˆGin æ¡†æ¶ï¼‰
âœ… å¥åº·æ£€æŸ¥æ¥å£ï¼ˆ/health, /readyï¼‰
âœ… ä¸šåŠ¡æ¥å£ï¼ˆ/api/v1/hello, /api/v1/infoï¼‰
âœ… Prometheus æŒ‡æ ‡æš´éœ²ï¼ˆ/metricsï¼‰
âœ… æ—¥å¿—ä¸­é—´ä»¶
âœ… ä¼˜é›…å…³é—­æœºåˆ¶
âœ… é…ç½®ç®¡ç†ï¼ˆç¯å¢ƒå˜é‡ï¼‰
```

### 2. Docker é•œåƒ

```
âœ… å¤šé˜¶æ®µæ„å»º
âœ… é•œåƒå¤§å° < 20MB
âœ… é™æ€ç¼–è¯‘ï¼ˆCGO_ENABLED=0ï¼‰
âœ… é root ç”¨æˆ·è¿è¡Œ
âœ… å¥åº·æ£€æŸ¥é…ç½®
âœ… Alpine Linux åŸºç¡€é•œåƒ
```

### 3. Kubernetes éƒ¨ç½²

```
âœ… Deployment é…ç½®ï¼ˆ2 å‰¯æœ¬ï¼‰
âœ… Service é…ç½®ï¼ˆNodePortï¼‰
âœ… èµ„æºé™åˆ¶ï¼ˆCPU/å†…å­˜ï¼‰
âœ… Liveness Probe
âœ… Readiness Probe
âœ… ç¯å¢ƒå˜é‡é…ç½®
```

### 4. æ–‡æ¡£

```
âœ… é¡¹ç›® README
âœ… v0.1 ç›®æ ‡å’Œäº¤ä»˜æ ‡å‡†
âœ… Kubernetes åŸºç¡€çŸ¥è¯†é€Ÿæˆ
âœ… ç¯å¢ƒæ­å»ºæŒ‡å—
âœ… éƒ¨ç½²æŒ‡å—
âœ… å®Œæˆæ€»ç»“ï¼ˆæœ¬æ–‡æ¡£ï¼‰
```

---

## ğŸ“Š éªŒæ”¶æ ‡å‡†æ£€æŸ¥

### âœ… æ‰€æœ‰æ ‡å‡†å·²è¾¾æˆï¼

- [x] API æœåŠ¡èƒ½åœ¨æœ¬åœ°è¿è¡Œ
- [x] Docker é•œåƒ < 20MB
- [x] K8s èƒ½éƒ¨ç½²å¹¶è®¿é—®æœåŠ¡
- [x] å¥åº·æ£€æŸ¥æ­£å¸¸å·¥ä½œ
- [x] 2 ä¸ª Pod éƒ½å¤„äº Running çŠ¶æ€
- [x] Service èƒ½é€šè¿‡ NodePort è®¿é—®
- [x] Prometheus æŒ‡æ ‡æ­£å¸¸æš´éœ²

---

## ğŸ“ å­¦åˆ°çš„çŸ¥è¯†

### æ ¸å¿ƒæ¦‚å¿µ

#### 1. **å®¹å™¨åŒ–**
- Docker å¤šé˜¶æ®µæ„å»º
- é•œåƒä¼˜åŒ–æŠ€å·§
- é™æ€ç¼–è¯‘
- å®‰å…¨æœ€ä½³å®è·µï¼ˆé root ç”¨æˆ·ï¼‰

#### 2. **Kubernetes åŸºç¡€**
- Podï¼šæœ€å°éƒ¨ç½²å•å…ƒ
- Deploymentï¼šç®¡ç† Pod ç”Ÿå‘½å‘¨æœŸ
- Serviceï¼šæœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡
- å¥åº·æ£€æŸ¥ï¼šLiveness å’Œ Readiness Probe

#### 3. **äº‘åŸç”Ÿæœ€ä½³å®è·µ**
- ä¼˜é›…å…³é—­ï¼ˆGraceful Shutdownï¼‰
- é…ç½®å¤–éƒ¨åŒ–ï¼ˆç¯å¢ƒå˜é‡ï¼‰
- å¥åº·æ£€æŸ¥ç«¯ç‚¹
- èµ„æºé™åˆ¶
- æ ‡ç­¾é€‰æ‹©å™¨

#### 4. **å¯è§‚æµ‹æ€§åŸºç¡€**
- Prometheus æŒ‡æ ‡æ”¶é›†
- ç»“æ„åŒ–æ—¥å¿—
- HTTP ä¸­é—´ä»¶æ¨¡å¼

---

## ğŸ“ˆ é¡¹ç›®æŒ‡æ ‡

### ä»£ç ç»Ÿè®¡

```
æºä»£ç æ–‡ä»¶ï¼š7 ä¸ª
  - main.go
  - config/config.go
  - handler/health.go
  - handler/hello.go
  - middleware/logger.go
  - middleware/metrics.go
  - metrics/prometheus.go

é…ç½®æ–‡ä»¶ï¼š4 ä¸ª
  - Dockerfile
  - go.mod
  - k8s/v0.1/deployment.yaml
  - k8s/v0.1/service.yaml

æ–‡æ¡£æ–‡ä»¶ï¼š6 ä¸ª
```

### é•œåƒå¤§å°

```
golang:1.21-alpine (æ„å»ºé˜¶æ®µ)ï¼š~150MB
alpine:latest (è¿è¡Œé˜¶æ®µåŸºç¡€)ï¼š  ~5MB
æœ€ç»ˆé•œåƒï¼š                      ~15-20MB

èŠ‚çœç©ºé—´ï¼š130MB+ï¼ˆèŠ‚çœ 87%ï¼‰
```

### K8s èµ„æº

```
Deploymentï¼š1 ä¸ª
  - å‰¯æœ¬æ•°ï¼š2
  - èµ„æºè¯·æ±‚ï¼šCPU 100mï¼Œå†…å­˜ 64Mi
  - èµ„æºé™åˆ¶ï¼šCPU 200mï¼Œå†…å­˜ 128Mi

Serviceï¼š1 ä¸ª
  - ç±»å‹ï¼šNodePort
  - ç«¯å£ï¼š8080:30080

Podï¼š2 ä¸ª
  - çŠ¶æ€ï¼šRunning
  - å¥åº·æ£€æŸ¥ï¼šé€šè¿‡
```

---

## ğŸš€ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### æœ¬åœ°å¼€å‘

```bash
# è¿è¡ŒæœåŠ¡
go run src/main.go

# æµ‹è¯•æ¥å£
curl http://localhost:8080/health
curl http://localhost:8080/api/v1/hello
```

### Docker

```bash
# æ„å»ºé•œåƒ
docker build -t cloudnative-go-api:v0.1 .

# è¿è¡Œå®¹å™¨
docker run -p 8080:8080 cloudnative-go-api:v0.1
```

### Kubernetes

```bash
# éƒ¨ç½²
kubectl apply -f k8s/v0.1/

# æŸ¥çœ‹çŠ¶æ€
kubectl get all

# è®¿é—®æœåŠ¡
minikube service api-service

# æŸ¥çœ‹æ—¥å¿—
kubectl logs -l app=api -f

# æ¸…ç†
kubectl delete -f k8s/v0.1/
```

---

## ğŸ’¡ å…³é”®æ”¶è·

### 1. **äº‘åŸç”Ÿæ€ç»´è½¬å˜**

```
ä¼ ç»Ÿå¼€å‘ï¼š
ä»£ç  â†’ è¿è¡Œ â†’ å®Œæˆ âœ“

äº‘åŸç”Ÿå¼€å‘ï¼š
ä»£ç  â†’ å®¹å™¨åŒ– â†’ ç¼–æ’ â†’ ç›‘æ§ â†’ å®Œæˆ âœ“
     â†‘ éœ€è¦è€ƒè™‘æ›´å¤š
```

### 2. **å£°æ˜å¼é…ç½®**

```yaml
# ä½ å‘Šè¯‰ K8s "æˆ‘è¦ä»€ä¹ˆ"
spec:
  replicas: 2

# K8s è´Ÿè´£"å¦‚ä½•å®ç°"
- åˆ›å»º 2 ä¸ª Pod
- ç›‘æ§çŠ¶æ€
- è‡ªåŠ¨æ¢å¤
```

### 3. **å¥åº·æ£€æŸ¥çš„é‡è¦æ€§**

```
æ²¡æœ‰å¥åº·æ£€æŸ¥ï¼š
- Pod æŒ‚äº†ä¸çŸ¥é“ âŒ
- æµé‡ç»§ç»­å‘é€åˆ°å Pod âŒ

æœ‰å¥åº·æ£€æŸ¥ï¼š
- Livenessï¼šæŒ‚äº†è‡ªåŠ¨é‡å¯ âœ…
- Readinessï¼šæ²¡å‡†å¤‡å¥½ä¸å‘æµé‡ âœ…
```

### 4. **èµ„æºé™åˆ¶çš„å¿…è¦æ€§**

```
æ²¡æœ‰é™åˆ¶ï¼š
- ä¸€ä¸ª Pod å æ»¡æ‰€æœ‰å†…å­˜ âŒ
- å…¶ä»– Pod è¢« OOM Kill âŒ

æœ‰é™åˆ¶ï¼š
- æ¯ä¸ª Pod åªèƒ½ç”¨è§„å®šçš„èµ„æº âœ…
- ä¿è¯å¤šä¸ª Pod å…±å­˜ âœ…
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### å·©å›º v0.1

1. **å®è·µ**ï¼š
   - å°è¯•ä¿®æ”¹ä»£ç ï¼Œé‡æ–°éƒ¨ç½²
   - ä½“éªŒæ»šåŠ¨æ›´æ–°
   - æ¨¡æ‹Ÿ Pod æ•…éšœ

2. **å®éªŒ**ï¼š
   ```bash
   # æ‰©å®¹åˆ° 3 ä¸ªå‰¯æœ¬
   kubectl scale deployment api-server --replicas=3
   
   # æŸ¥çœ‹è´Ÿè½½å‡è¡¡
   for i in {1..10}; do curl $(minikube service api-service --url)/api/v1/info; done
   
   # åˆ é™¤ä¸€ä¸ª Podï¼Œè§‚å¯Ÿè‡ªåŠ¨é‡å»º
   kubectl delete pod <pod-name>
   kubectl get pods -w
   ```

3. **ä¼˜åŒ–**ï¼š
   - å°è¯•å‡å°é•œåƒä½“ç§¯
   - è°ƒæ•´èµ„æºé™åˆ¶
   - ä¼˜åŒ–å¥åº·æ£€æŸ¥å‚æ•°

---

### å‡†å¤‡ v0.2

ä¸‹ä¸€ä¸ªç‰ˆæœ¬å°†å­¦ä¹ ï¼š

```
âœ¨ StatefulSetï¼ˆæœ‰çŠ¶æ€åº”ç”¨ï¼‰
   - éƒ¨ç½² Redis é›†ç¾¤
   - æŒä¹…åŒ–å­˜å‚¨

âœ¨ DaemonSetï¼ˆæ¯èŠ‚ç‚¹ä¸€ä¸ªï¼‰
   - æ—¥å¿—é‡‡é›†å™¨

âœ¨ CronJobï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰
   - æ•°æ®æ¸…ç†ä»»åŠ¡

âœ¨ ConfigMap å’Œ Secret
   - é…ç½®ç®¡ç†è¿›é˜¶
```

**é¢„è®¡æ—¶é—´**ï¼š2-3 å‘¨ï¼ˆä¸šä½™æ—¶é—´ï¼‰

---

## ğŸ“š æ¨èèµ„æº

### æ·±å…¥å­¦ä¹ 

1. **Docker**
   - [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
   - [å¤šé˜¶æ®µæ„å»ºæœ€ä½³å®è·µ](https://docs.docker.com/build/building/multi-stage/)

2. **Kubernetes**
   - [Kubernetes å®˜æ–¹æ•™ç¨‹](https://kubernetes.io/zh-cn/docs/tutorials/)
   - [K8s æ¨¡å¼](https://www.oreilly.com/library/view/kubernetes-patterns/9781492050278/)

3. **Go**
   - [Effective Go](https://go.dev/doc/effective_go)
   - [Go by Example](https://gobyexample.com/)

4. **Prometheus**
   - [Prometheus å…¥é—¨](https://prometheus.io/docs/introduction/overview/)
   - [Go Client æ–‡æ¡£](https://pkg.go.dev/github.com/prometheus/client_golang)

---

## ğŸ† å®Œæˆæˆå°±

æ­å–œä½ å®Œæˆ v0.1ï¼ä½ å·²ç»æŒæ¡äº†ï¼š

```
âœ… Go Web åº”ç”¨å¼€å‘
âœ… Docker å®¹å™¨åŒ–
âœ… Kubernetes éƒ¨ç½²
âœ… äº‘åŸç”Ÿæœ€ä½³å®è·µ
âœ… åŸºç¡€çš„å¯è§‚æµ‹æ€§

è¿™äº›æ˜¯äº‘åŸç”Ÿå·¥ç¨‹å¸ˆçš„æ ¸å¿ƒæŠ€èƒ½ï¼
```

---

## ğŸ“ é—®é¢˜åé¦ˆ

é‡åˆ°é—®é¢˜ï¼Ÿ
- æŸ¥çœ‹ [FAQ](../v0.1/FAQ.md)
- æŸ¥çœ‹ [æ•…éšœæ’æŸ¥æŒ‡å—](../v0.1/TROUBLESHOOTING.md)
- æ GitHub Issue

---

## ğŸ‰ æ­å–œï¼

**ä½ å·²ç»å®Œæˆäº†äº‘åŸç”Ÿ Go ä¹‹æ—…çš„ç¬¬ä¸€æ­¥ï¼**

ç»§ç»­ä¿æŒå­¦ä¹ çš„çƒ­æƒ…ï¼Œv0.2 è§ï¼ğŸš€

---

**å®Œæˆæ—¥æœŸ**ï¼š2025-10-26  
**ç‰ˆæœ¬**ï¼šv0.1.0  
**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ
